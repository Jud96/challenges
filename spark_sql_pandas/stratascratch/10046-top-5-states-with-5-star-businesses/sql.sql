WITH
	TOP_BUSINESSES AS (
		SELECT
			STATE,
			COUNT(DISTINCT BUSINESS_ID) AS N_BUSINESSES
		FROM
			YELP_BUSINESS
		WHERE
			STARS = 5
		GROUP BY
			STATE
		ORDER BY
			2 DESC,
			1 ASC
	)
SELECT
	STATE,
	N_BUSINESSES
FROM
	TOP_BUSINESSES
WHERE
	N_BUSINESSES >= (
		SELECT
			MIN(T.N_BUSINESSES)
		FROM
			(
				SELECT
					N_BUSINESSES
				FROM
					TOP_BUSINESSES
				LIMIT
					5
			) T
	)